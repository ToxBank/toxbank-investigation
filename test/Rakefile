require 'rubygems'
require 'opentox-server'
#require File.join(File.dirname(__FILE__),"../lib/toxbank-investigation.rb")
#['otlogger', 'environment', 'helper'].each do |lib|
	#require '../lib/' + lib
#end

HOST = "http://localhost/"
AA_SERVER = "https://opensso.in-silico.ch"
TEST_USER = "guest"
TEST_PW = "guest"

=begin
task ARGV[0] do
  puts "Environment: #{ENV["RACK_ENV"]}"
  ARGV[0] = ARGV[0].gsub(/\.rb$/,"")
  puts "Test: "+ARGV[0]+".rb"
  puts File.join(File.dirname(__FILE__),ARGV[0]+".rb")
  #require File.join(File.dirname(__FILE__),ARGV[0]+".rb")
  require "./"+ARGV[0]+".rb"
end
=end

task ARGV[0] do
  puts "Environment: #{ENV["RACK_ENV"]}"
  ARGV[0] = ARGV[0].gsub(/\.rb$/,"")
  puts "Test: "+ARGV[0]+".rb"
  require "./"+ARGV[0]+".rb"
end

task :setup do
  # setup code
  resource = RestClient::Resource.new("#{AA_SERVER}/auth/authenticate")
  @@subjectid = resource.post(:username=>TEST_USER, :password => TEST_PW).sub("token.id=","").sub("\n","")
end

task :teardown do
  # teardown code
end

[:all, :upload, :import4s, :basic_rest, :xls_upload, :querytest].each do |t|
  task :teardown => t
  task t => :setup
end
